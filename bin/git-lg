#!/bin/bash

count=$(git rev-list HEAD --count)
limit=25

if [ -n "$GIT_LOG_LIMIT" ]; then
	limit=$GIT_LOG_LIMIT
fi

if [ -n "$1" ]; then
	regex='^[0-9]+$'
	if [[ "$1" =~ $regex ]]; then
		limit=$1
	else
		echo "ERROR: Invalid limit value: $1" 1>&2
		exit 1
	fi
fi

git log --graph --pretty="%Cred%h %Cgreen%ai %Cblue%an <%ae>%Creset %s%C(yellow)%d" -n $limit

if [ $count -gt $limit ]; then
	echo "[ *** Showing only the last $limit log lines of $count total log lines *** ]"
fi
