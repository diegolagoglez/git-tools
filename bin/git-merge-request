#!/bin/bash

# Diego Lago <diego.lago.gonzalez@gmail.com>

MERGE_REQUEST_PREFFIX=merge-request

function error {
	error_msg="$1"
	exit_code=$2
	echo "ERROR: $error_msg" 1>&2
	if [ $exit_code -ne 0 ]; then
		exit $exit_code
	fi
}

function usage {
	echo "$(basename $0) - Utility to make merge requests to a Git repository."
	echo "Usage: $(basename $0) <command> [<options>]"
	echo "Commands:"
	echo "  make          : Makes a merge request."
	echo "  approve       : Approves a merge request."
	echo "  reject        : Rejects a merge request."
	echo "  list          : List all pending merge requests."
	echo "  help <command>: Show help about the given command."
}

function make_merge_request {
	if [ $# -ne 0 ]; then
		echo
	else
		error "Invalid options for command." 1
	fi
}

function show_help {
	if [ $# -ne 0 ]; then
		case $1 in
			make)
				echo "Usage: git merge-request make <local-branch> <remote>"
			;;
			help)
				echo "Help about help? Oh, yeah!"
			;;
		esac
	else
		error "No command specified." 1
	fi	
}

function main {
	if [ $# -ne 0 ]; then
		command="$1"
		shift
		case $command in
			make)
				make_merge_request $@
			;;
			approve)
			;;
			reject)
			;;
			list)
			;;
			help)
				show_help $@
			;;
			*)
				error "Invalid command: $command" 1
			;;
		esac
	else
		usage
	fi
}

main $@
